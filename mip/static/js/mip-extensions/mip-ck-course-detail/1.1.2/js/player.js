define("mip-ck-course-detail/js/player",["require","zepto","./mediator","./tpl-data","./lib/video","./lib/videojs-contrib-hls"],function(t){function e(){b=f.get("courseInfo"),_=b.courseid,w=b.sid,x=b.cid,k=b.uid,T=b.type,S=f.get("playerInfo"),E=S.hasVideo,j=S.preVideoSrc,P=S.vodSource,C=S.coverUrl}function i(t){v=m("video"),v.src({src:t.src,code:t.key,courseid:_+"",sid:w+"",cid:(t.cid||x)+"",uid:k+"",type:t.src.indexOf(".mp4")>-1?"":"application/x-mpegURL"})}function n(){g=p(".video"),y=p('<video id="video" class="video-js vjs-default-skin link" poster="'+C+'" controls></video>'),g.prepend(y)}function r(){if(P.length>0)i(P[0]);else i({src:j[0],key:""})}function o(){if(1===T)d.trigger("trial-next")}function s(t){if(t<=0)return clearTimeout(O),O=null,p("#play-end").hide(),void o();p("#auto_play_num").text(t),O=setTimeout(function(){s(t-1)},1e3)}function a(){if(A)d.trigger("toggle-app-download-banner")}function l(){var t=y[0];if(v.currentTime()>=parseInt(v.duration(),10)-1)if(1===T)t.load(),s(3),d.trigger("toggle-end-pop");else if(2===T)t.load(),p("#trial-end").show()}function c(){v.on("pause",a),v.on("ended",l)}function u(){v.off("pause",a),v.off("ended",l),v.dispose()}function h(){if(e(),E)d.on("toggle-app-download-flag",function(t,e){var i=e.show;A=!!i}),d.on("change-video-src",function(t,e){if(v)u();n(),i(e.data),c(),p("#video_loading").remove(),d.trigger("toggle-app-download-banner",!0),A=!0}),p("#play-next-class").on("click",function(){o()}),n(),r(),c()}var p=t("zepto"),d=t("./mediator"),f=t("./tpl-data"),m=t("./lib/video");window.videojs=m;var g,y,v,b,_,w,x,k,T,S,E,j,P,C,O,A=(t("./lib/videojs-contrib-hls"),!0);return h});